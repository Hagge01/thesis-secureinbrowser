<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Verify Email</title>
  </head>
  <body>
    <h1>Verify Email</h1>
    <form onsubmit="return verifyEmail(event)">
      <label>
        Verification Code:
        <br>
        <input type="text" id="verificationCode" name="verificationCode" required>
      </label>
      <br>
      <button type="submit">Submit</button>
    </form>

    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1356.0.min.js"></script>
    <script>
      AWS.config.region = 'eu-north-1'; // Replace with your region
      var cognitoidentityserviceprovider = new AWS.CognitoIdentityServiceProvider();

      function verifyEmail(event) {
        // Get the username from the URL query parameters
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const username2 = urlParams.get('username');

// Use the username to display a message or perform some other action
console.log('Please verify your email address for user: ' + username);

        event.preventDefault();
        var verificationCode = document.getElementById('verificationCode').value;
        var username = username2; // Replace with the username you want to verify
        var params = {
          ClientId: '7r2bam11ounrq97okspbpjrtv0', // Replace with your app client ID
          Username: username,
          ConfirmationCode: verificationCode
        };
        cognitoidentityserviceprovider.confirmSignUp(params, function(err, data) {
          if (err) {
            alert(err.message);
          } else {
            alert('Email verified successfully!');
            // Redirect the user to the login page
            window.location.href = 'https://thesis-secureinbrowser.s3.eu-north-1.amazonaws.com/pages/index.html';
          }
        });
      }
    </script>
  </body>
</html>
