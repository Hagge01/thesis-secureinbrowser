<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="/js/amazon-cognito-identity.js"></script>

  <link rel="stylesheet" href="./styles.css" />
  <title>SimpleWebAuthn Example Site Using Amazon Cognito</title>
</head>
<body>
<div class="container">
  <h1>SimpleWebAuthn Example Site Using Amazon Cognito</h1>

  <div class="controls">
    <section id="registration">
      <input type="text" id="regUsername" placeholder="Enter email address">
      <br><br >
      <button id="btnRegBegin">
        <strong>üö™&nbsp;Register</strong>
      </button>
      <p id="regSuccess" class="success"></p>
      <p id="regError" class="error"></p>
      <details open>
        <summary>Console</summary>
        <textarea id="regDebug" spellcheck="false"></textarea>
      </details>
    </section>

    <section id="authentication">
      <input type="text" id="authUsername" placeholder="Enter email address">
      <br><br >
      <button id="btnAuthBegin">
        <strong>üîê&nbsp;Authenticate</strong>
      </button>
      <p id="authSuccess" class="success"></p>
      <p id="authError" class="error"></p>
      <details open>
        <summary>Console</summary>
        <textarea id="authDebug" spellcheck="false"></textarea>
      </details>
    </section>
  </div>

  <p class="systemError"></p>
</div>
<script>
  const { CognitoUserPool, CognitoUserAttribute, CognitoUser, AuthenticationDetails } = AmazonCognitoIdentity;

  /**
   * A simple way to control how debug content is written to a debug console element
   */
  function printDebug(elemDebug, title, output) {
    if (elemDebug.innerHTML !== '') {
      elemDebug.innerHTML += '\n';
    }
    elemDebug.innerHTML += `// ${title}\n`;
    elemDebug.innerHTML += `${output}\n`;
  }

  /**
   * A function to return a configured CognitoUserPool object for signing up and authenticating users
   */
  let userPool;
  async function getAmazonCognitoUserPool() {

    // We only need to create this object once, so let's only do so if we haven't already
    if (!userPool) {
      // A neat trick, we can determine the dynamically generated UserPoolId and ClientId from this page's headers (S3 Object Metadata)
      const cognitoMetadataResp = await fetch('', {
        method: 'HEAD',
      });

      userPool = new CognitoUserPool({
        UserPoolId: cognitoMetadataResp.headers.get('x-amz-meta-userpoolid'),
        ClientId: cognitoMetadataResp.headers.get('x-amz-meta-clientid')
      });
    }
    return userPool;
  }


</script>
</body>
</html>